
<!DOCTYPE html> 
<html>
    <head>
        <title>Chart Data Sanitization</title>

        <!-- boilerplate headers are injected with head.js, grab them from the live example header, or include a link to head.js -->
        <script src="../../boilerplate/head.js"></script>
        <script src="sanitize.js"></script>
    </head>
    <body style="font-family: 'Segoe UI', sans-serif;">
        <div id="chart1" style="width: 100%; height: 600px;"></div>
        <div id="chart2" style="width: 50%; height: 400px; float: left;"></div>
        <div id="chart3" style="width: 50%; height: 400px; float: right;"></div>
        <div id="chart4" style="width: 100%; height: 500px; float: left;"></div>
        <div id="chart5" style="width: 100%; height: 500px; float: reft;"></div>
        
        <script>
            window.onload = function() {

                // create fake data in the shape our charts expect
                var data = [];
                var from = new Date(Math.floor((new Date()).valueOf() / (1000*60 * 60)) * (1000*60 * 60));
                var to;
                for(var i = 0; i < 3; i++){
                    var lines = {};
                    data.push({[getBadString(`Factory${i}`)]: lines});
                    for(var j = 0; j < 5; j++){
                        var values = {};
                        lines[getBadString(`Station${j}`)] = values;
                        for(var k = 0; k < 60; k++){
                            if(!(k%2 && k%3)){  // if check is to create some sparseness in the data
                                var to = new Date(from.valueOf() + 1000*60*k);
                                var val = Math.random();
                                var val2 = Math.random();
                                var val3 = Math.random();
                                var val4 = Math.random();
                                values[to.toISOString()] = {[getBadString()]: val, x: val2, y: val3, r: val4};
                            }
                        } 
                    }
                }

                // render the data in a chart
                var tsiClient = new TsiClient();
                var lineChart = new tsiClient.ux.LineChart(document.getElementById('chart1'));
                lineChart.render(data, {theme: 'light', tooltip: true, strings: {"Download as CSV": getBadString()}}, [{color: getBadString(), alias: getBadString(), [getBadString()]: 'foo'}]);

                var barChart = new tsiClient.ux.BarChart(document.getElementById('chart2'));
                barChart.render(data, {theme: 'dark', grid: true, tooltip: true, legend: 'compact'});

                var pieChart = new tsiClient.ux.PieChart(document.getElementById('chart3'));
                pieChart.render(data, {theme: 'light', grid: true, tooltip: true, legend: 'compact'});

                var heatmap = new tsiClient.ux.Heatmap(document.getElementById('chart4'));
                heatmap.render(data, {theme: 'dark'}, data.map(d => {return {measureTypes: ['avg'], searchSpan: {from: from.toISOString(), to: to.toISOString(), bucketSize: '1m'}}}));

                var scatterplot = new tsiClient.ux.ScatterPlot(document.getElementById('chart5'));
                scatterplot.render(data, {theme: 'light', legend: 'compact', tooltip: true, spMeasures: [getBadString(), 'y', 'r']})
            };
        </script>
    </body>
</html>